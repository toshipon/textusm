# TextUSM 仮説キャンバス VS Code 拡張機能 設計ドキュメント

## プロジェクト概要

このプロジェクトは、オープンソースの TextUSM をベースにした**VS Code 拡張機能**です。LLM を活用して仮説キャンバスを簡単に作成・編集し、リアルタイムでプレビューできる機能を提供します。バックエンド機能は不要で、完全に VS Code 拡張機能として動作します。

## アーキテクチャ

### 主要コンポーネント

- **VS Code 拡張基盤**: VS Code の拡張 API を活用した機能実装
- **LLM インテグレーション**: 様々な LLM API と連携するコネクタ
- **マークダウンパーサー**: TextUSM の仮説キャンバス記法を処理
- **プレビューレンダラー**: 仮説キャンバスを WebView で視覚化

### 動作フロー

1. ユーザーが VS Code 内でマークダウンファイルを編集または拡張機能のチャットインターフェースを使用
2. LLM がユーザーの入力に基づいて仮説キャンバスのコンテンツを生成・修正
3. 生成されたマークダウンがファイルに反映される
4. プレビュー機能で仮説キャンバスが視覚的に表示される

## VS Code 拡張機能 - 仮説キャンバス機能 (2025-04-05 追加)

- **目標:** LLM を使用してユーザーが仮説キャンバスを作成および改良するのを支援する機能で VS Code 拡張機能を強化する。
- **LLM 連携:** Gemini、Claude、GitHub Copilot、OpenAI をサポート。
- **ユーザーインターフェース:**
  - LLM API キーを設定するための専用画面。
  - インタラクティブなキャンバス構築のためのチャットインターフェース（GitHub Copilot Chat に類似）。
  - チャット内から仮説キャンバスのマークダウンファイルをプレビューするためのリンク。
- **機能:**
  - LLM がキャンバスのセクションのブレインストーミングと改良を支援。
  - チャットの会話が関連するマークダウンファイルを直接更新。
- **README 更新:** この機能の説明をメインの `README.md` に追加済み。

## 拡張機能の具体的な機能

### LLM インテグレーション

- **プロンプトテンプレート**: 仮説キャンバスの各セクション向けに最適化されたプロンプト
- **コンテキスト管理**: 会話の流れを維持し、一貫した仮説構築をサポート
- **マルチ LLM サポート**: 複数の LLM API から選択可能
- **API キー管理**: VS Code 拡張のシークレットストレージを使用した安全な認証情報管理

### エディタ連携

- **マークダウンハイライト**: 仮説キャンバス形式の構文強調表示
- **スニペット**: 一般的な仮説キャンバスパターンの挿入機能
- **コマンドパレット**: 各種機能へのクイックアクセス
- **キーボードショートカット**: 頻繁に使用する機能のショートカット

### プレビュー機能

- **リアルタイムレンダリング**: 編集内容の即時反映
- **インタラクティブビュー**: クリックやホバーでの追加情報表示
- **エクスポート**: プレビューから PNG、SVG へのエクスポート
- **カスタムテーマ**: VS Code のテーマに合わせたプレビュー表示

## 開発ロードマップ

### フェーズ 1 (基盤構築)

- VS Code 拡張の基本構造設定
- TextUSM パーサーの仮説キャンバス対応
- 基本的なプレビュー機能実装

### フェーズ 2 (LLM 連携)

- LLM API コネクタ実装
- チャットインターフェース構築
- プロンプトテンプレート開発

### フェーズ 3 (UX 向上)

- インタラクティブ機能強化
- エラー処理とフィードバック改善
- パフォーマンス最適化

## テスト戦略

- **単体テスト**: コアロジックと拡張機能コマンドのテスト
- **統合テスト**: VS Code API 連携のテスト
- **エンドユーザーテスト**: 実際のシナリオに基づいたユーザビリティ検証

## 配布と展開

- **VS Code Marketplace**: 拡張機能の公開と更新
- **GitHub**: ソースコードとドキュメントのホスティング
- **バージョニング**: セマンティックバージョニングに従った更新管理
